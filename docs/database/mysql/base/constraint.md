---
order : 4
---
# 约束

## 概念
约束是作用于表中字段上的规则，用于限制存储在表中的数据。

## 目的
为了保证数据库中数据的正确、有效性和完整性。


## 分类
|约束|描述|关键字|
|:---:|:---:|:---:|
|非空约束|限制该字段的数据不能为null|NOT NULL|
|唯一约束|保证该字段的所有数据都是唯一，不重复的|UNIQUE|
|主键约束|主键是一行数据的唯一标识，要求非空且唯一|PRIMARY KEY|
|默认约束|保存数据时，如果未指定该字段的值，则赋予该默认值|DEFULT|
|条件约束<Badge text="8.0.16版本以后" type="warning" />|保证字段值满足指定的条件|CHECK|
|外键约束|用来让两张表的数据之间建立连接，保证数据的一致性和完整性|FOREIGN KEY|

::: warning 注意
约束是作用于表中字段上的，可以在创建表/修改表的时候添加约束。
:::

## 外键约束
其他5种约束的适用方法较为简单，这里仅对外键约束做详细介绍。
### 语法
1. 添加外键
```sql
-- 建表时添加外键
CREATE TABLE 表名( 
    字段名 数据类型,
     ... 
    [CONSTRAINT] [外键名称] FOREIGN KEY (外键字段名) REFERENCES 主表 (主表列名) );
-- 建表后添加外键
ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段名) REFERENCES 主表(主表列名);
```
2. 删除外键
```sql
ALTER TABLE 表名 DROP FOREIGN KEY 外键名称;
```

### 删除/更新行为

添加了外键之后，再删除父表数据时产生的约束行为，我们就称为删除/更新行为。具体的删除/更新行
为有以下几种:

|行为|说明|
|:---:|:---:|
|NO ACTION|当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新。(与RESTRICT一致)默认行为
|RESTRICT|当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新。(与NO ACTION一致)默认行为
|CASCADE|当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有，则也删除/更新外键在子表中的记录。|
|SET NULL|当在父表中删除对应记录时，首先检查该记录是否有对应外键，如果有则设置子表中该外键值为null（这就要求该外键允许取null）。|
|SET DEFAULT|父表有变更时，子表将外键列设置成一个默认的值(Innodb不支持)|

```sql
ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段) REFERENCES 主表名 (主表字段名) ON UPDATE CASCADE ON DELETE CASCADE;
```